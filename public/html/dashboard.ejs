const express = require("express");
const cors = require("cors");
const bodyParser = require("body-parser");

const app = express();
const port = 3000;

// Middleware
app.use(cors());
app.use(bodyParser.json());

// Simpan sesi (contoh data sementara untuk simulasi)
let activeSessions = {};

// Rute untuk menyimpan data sesi
app.post("/save-session", (req, res) => {
    const { growId, password } = req.body;

    if (growId && password) {
        activeSessions[growId] = { growId, password };
        return res.json({ success: true, message: "Session saved!" });
    }
    return res.json({ success: false, message: "Invalid data!" });
});

// Rute untuk menghubungkan ke sesi terakhir
app.post("/connect-session", (req, res) => {
    const { growId, password } = req.body;

    if (activeSessions[growId] && activeSessions[growId].password === password) {
        return res.json({ success: true, message: "Connected to the session!" });
    }
    return res.json({ success: false, message: "Invalid session credentials!" });
});

// Jalankan server
app.listen(port, () => {
    console.log(`Server running on http://localhost:${port}`);
});
